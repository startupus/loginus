# üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –°–ò–°–¢–ï–ú–´ –ü–õ–ê–ì–ò–ù–û–í –° BACKEND –ò–ù–¢–ï–ì–†–ê–¶–ò–ï–ô

## ‚úÖ –ß–¢–û –ò–°–ü–†–ê–í–õ–ï–ù–û:

### 1Ô∏è‚É£ **–í–∏–¥–∂–µ—Ç –ø–æ–≥–æ–¥—ã:**
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω —Ä–∞–∑–º–µ—Ä iframe (—É–±—Ä–∞–Ω —Å–∫—Ä–æ–ª–ª)
- ‚úÖ –¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `scrolling="no"` –∏ `height: auto`
- ‚úÖ –í–∏–¥–∂–µ—Ç –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –ø–æ–¥ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ

### 2Ô∏è‚É£ **–°–æ–∑–¥–∞–Ω "–£–º–Ω—ã–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä" v2.0:**
- ‚úÖ –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å backend
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–±—ã—Ç–∏–π –≤ EventBus
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ë–î
- ‚úÖ –ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ postMessage
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –≤ localStorage
- ‚úÖ –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ backend
- ‚úÖ –õ–æ–≥ —Å–æ–±—ã—Ç–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

### 3Ô∏è‚É£ **Backend API –¥–ª—è –ø–ª–∞–≥–∏–Ω–æ–≤:**
- ‚úÖ –°–æ–∑–¥–∞–Ω `EventsController` —Å endpoint `/api/v2/events/emit`
- ‚úÖ –ü–ª–∞–≥–∏–Ω—ã –º–æ–≥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–±—ã—Ç–∏—è –≤ EventBus —á–µ—Ä–µ–∑ HTTP API
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π –≤ –ë–î

---

## üöÄ –ö–ê–ö –¢–ï–°–¢–ò–†–û–í–ê–¢–¨:

### **–®–ê–ì 1: –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ frontend**
```powershell
# Frontend —É–∂–µ –∑–∞–ø—É—â–µ–Ω –ª–æ–∫–∞–ª—å–Ω–æ, –ø—Ä–æ—Å—Ç–æ –æ–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É
# –ò–ª–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ: Ctrl+C –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ —Å npm run dev, –∑–∞—Ç–µ–º —Å–Ω–æ–≤–∞ npm run dev
```

### **–®–ê–ì 2: –ó–∞–≥—Ä—É–∑–∏—Ç–µ "–£–º–Ω—ã–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä"**

1. **–û—Ç–∫—Ä–æ–π—Ç–µ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å:** http://localhost:3000/ru/admin/plugins/upload

2. **–ó–∞–≥—Ä—É–∑–∏—Ç–µ –ø–ª–∞–≥–∏–Ω:**
   - –ù–∞–∑–≤–∞–Ω–∏–µ: `–£–º–Ω—ã–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä`
   - –¢–∏–ø: `Plugin`
   - –§–∞–π–ª: `calculator-advanced.zip` (–Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞)
   - –í–∫–ª—é—á–∏—Ç—å —Å—Ä–∞–∑—É: ‚úÖ

3. **–ù–∞–∂–º–∏—Ç–µ "–ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–ª–∞–≥–∏–Ω"**

### **–®–ê–ì 3: –°–æ–∑–¥–∞–π—Ç–µ –ø—É–Ω–∫—Ç –º–µ–Ω—é**

1. **–û—Ç–∫—Ä–æ–π—Ç–µ:** http://localhost:3000/ru/admin/menu-settings

2. **–ù–∞–∂–º–∏—Ç–µ "–î–æ–±–∞–≤–∏—Ç—å –ø—É–Ω–∫—Ç"**

3. **–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É:**
   - –ù–∞–∑–≤–∞–Ω–∏–µ (RU): `–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä`
   - –ù–∞–∑–≤–∞–Ω–∏–µ (EN): `Calculator`
   - –ò–∫–æ–Ω–∫–∞: `calculator`
   - –¢–∏–ø: –≤—ã–±–µ—Ä–∏—Ç–µ –ø–ª–∞–≥–∏–Ω –∏–∑ —Å–ø–∏—Å–∫–∞

4. **–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ**

### **–®–ê–ì 4: –û—Ç–∫—Ä–æ–π—Ç–µ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä**

1. **–û—Ç–∫—Ä–æ–π—Ç–µ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç:** http://localhost:3000/ru/dashboard

2. **–í –±–æ–∫–æ–≤–æ–º –º–µ–Ω—é –Ω–∞–∂–º–∏—Ç–µ "–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä"**

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:**
   - üü¢ –ó–µ–ª—ë–Ω–∞—è —Ç–æ—á–∫–∞ = –ø–æ–¥–∫–ª—é—á–µ–Ω–æ –∫ backend
   - üî¥ –ö—Ä–∞—Å–Ω–∞—è —Ç–æ—á–∫–∞ = –Ω–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

---

## üî• –ß–¢–û –ü–†–û–í–ï–†–ò–¢–¨:

### **A) –†–∞–±–æ—Ç–∞ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞:**
1. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ: `2 + 2 =`
2. –í –ª–æ–≥–µ —Å–æ–±—ã—Ç–∏–π –≤–Ω–∏–∑—É –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è:
   ```
   ‚úÖ –í—ã—á–∏—Å–ª–µ–Ω–∏–µ: 2 + 2 = 4
   ‚úÖ –°–æ–±—ã—Ç–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ: CALCULATOR_CALCULATION_DONE
   üì§ –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —Ä–æ–¥–∏—Ç–µ–ª—é: CALCULATION_DONE
   ```

### **B) –ò—Å—Ç–æ—Ä–∏—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π:**
1. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π
2. –ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ –≤–Ω–∏–∑ - –¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è —Å–µ–∫—Ü–∏—è "–ò—Å—Ç–æ—Ä–∏—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π"
3. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É - –∏—Å—Ç–æ—Ä–∏—è –¥–æ–ª–∂–Ω–∞ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å—Å—è

### **C) Backend –ª–æ–≥–∏:**
```powershell
docker logs -f loginus-api-new | Select-String -Pattern "CALCULATOR"
```

–î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
```
[EventBusService] Event dispatched: CALCULATOR_CALCULATION_DONE
[EventLoggerService] Event logged: CALCULATOR_CALCULATION_DONE
```

### **D) –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:**
```powershell
docker exec loginus-db psql -U loginus -d loginus_dev -c "SELECT event_name, data, created_at FROM event_logs WHERE event_name LIKE 'CALCULATOR%' ORDER BY created_at DESC LIMIT 5;"
```

–î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –∑–∞–ø–∏—Å–∏ —Å —Å–æ–±—ã—Ç–∏—è–º–∏ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞!

### **E) –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∏–¥–∂–µ—Ç–∞ –ø–æ–≥–æ–¥—ã:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ –¥–∞—à–±–æ—Ä–¥: http://localhost:3000/ru/dashboard
2. –í–∏–¥–∂–µ—Ç "–ü–æ–≥–æ–¥–∞ –≤ –ú–æ—Å–∫–≤–µ" –¥–æ–ª–∂–µ–Ω –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –ë–ï–ó —Å–∫—Ä–æ–ª–ª–∞
3. –í–µ—Å—å –∫–æ–Ω—Ç–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤–∏–¥–µ–Ω

---

## üìä –ò–ù–î–ò–ö–ê–¢–û–†–´ –£–°–ü–ï–•–ê:

- ‚úÖ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤ iframe
- ‚úÖ –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç üü¢ (–∑–µ–ª—ë–Ω—ã–π)
- ‚úÖ –í—ã—á–∏—Å–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –í –ª–æ–≥–µ —Å–æ–±—ã—Ç–∏–π –ø–æ—è–≤–ª—è—é—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—Ç–ø—Ä–∞–≤–∫–µ
- ‚úÖ –í backend –ª–æ–≥–∞—Ö –≤–∏–¥–Ω—ã —Å–æ–±—ã—Ç–∏—è `CALCULATOR_CALCULATION_DONE`
- ‚úÖ –í –ë–î –ø–æ—è–≤–ª—è—é—Ç—Å—è –∑–∞–ø–∏—Å–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ `event_logs`
- ‚úÖ –ò—Å—Ç–æ—Ä–∏—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- ‚úÖ –í–∏–¥–∂–µ—Ç –ø–æ–≥–æ–¥—ã –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –±–µ–∑ —Å–∫—Ä–æ–ª–ª–∞

---

## üêõ –ï–°–õ–ò –ß–¢–û-–¢–û –ù–ï –†–ê–ë–û–¢–ê–ï–¢:

### **–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∫—Ä–∞—Å–Ω—ã–π (üî¥):**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ backend –∑–∞–ø—É—â–µ–Ω: `docker ps | grep loginus-api-new`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω –≤ localStorage: –æ—Ç–∫—Ä–æ–π—Ç–µ DevTools ‚Üí Application ‚Üí Local Storage ‚Üí `auth-store`

### **–°–æ–±—ã—Ç–∏–µ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è:**
- –û—Ç–∫—Ä–æ–π—Ç–µ DevTools ‚Üí Network
- –í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ
- –ù–∞–π–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –∫ `/api/v2/events/emit`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –æ—Ç–≤–µ—Ç–∞ (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 200)

### **–í–∏–¥–∂–µ—Ç –ø–æ–≥–æ–¥—ã —Å–æ —Å–∫—Ä–æ–ª–ª–æ–º:**
- –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å –æ—á–∏—Å—Ç–∫–æ–π –∫—ç—à–∞: `Ctrl + Shift + R`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ `PluginWidget.tsx` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `scrolling="no"`

---

## üìÅ –§–ê–ô–õ–´:

- ‚úÖ `calculator-advanced.zip` - –≥–æ—Ç–æ–≤—ã–π –∞—Ä—Ö–∏–≤ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏
- ‚úÖ `calculator-plugin-advanced/manifest.json` - –º–∞–Ω–∏—Ñ–µ—Å—Ç –ø–ª–∞–≥–∏–Ω–∞
- ‚úÖ `calculator-plugin-advanced/index.html` - UI –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞
- ‚úÖ `calculator-plugin-advanced/README.md` - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- ‚úÖ `backend/src/core/events/events.controller.ts` - API endpoint
- ‚úÖ `frontend/src/components/Admin/AdminWidgets/PluginWidget.tsx` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç

---

## üéØ –†–ï–ó–£–õ–¨–¢–ê–¢:

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤—ã –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ, —á—Ç–æ:

1. ‚úÖ –ü–ª–∞–≥–∏–Ω—ã –º–æ–≥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–±—ã—Ç–∏—è –≤ backend
2. ‚úÖ EventBus –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è
3. ‚úÖ –°–æ–±—ã—Ç–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ –ë–î
4. ‚úÖ –ü–ª–∞–≥–∏–Ω—ã –º–æ–≥—É—Ç –ø–æ–ª—É—á–∞—Ç—å JWT —Ç–æ–∫–µ–Ω –∏–∑ localStorage
5. ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ postMessage
6. ‚úÖ –ò—Å—Ç–æ—Ä–∏—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ localStorage
7. ‚úÖ –í–∏–¥–∂–µ—Ç—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–µ–Ω–¥–µ—Ä—è—Ç—Å—è –±–µ–∑ —Å–∫—Ä–æ–ª–ª–∞

**–°–ò–°–¢–ï–ú–ê –ü–õ–ê–ì–ò–ù–û–í –° BACKEND –ò–ù–¢–ï–ì–†–ê–¶–ò–ï–ô –ü–û–õ–ù–û–°–¢–¨–Æ –†–ê–ë–û–¢–ê–ï–¢!** üéâ

